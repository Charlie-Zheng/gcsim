(function(){"use strict";self.importScripts("../wasm_exec.js"),WebAssembly.instantiateStreaming||(WebAssembly.instantiateStreaming=async(e,r)=>{const a=await(await e).arrayBuffer();return await WebAssembly.instantiate(a,r)});function s(e){const r=new Go;WebAssembly.instantiateStreaming(fetch(e.wasm),r.importObject).then(a=>{r.run(a.instance),console.log("aggregator loaded okay"),postMessage({type:t.Ready})}).catch(a=>{console.error(a),postMessage({type:t.Failed,reason:a instanceof Error?a.message:"Unknown Error"})})}function i(e){const r=JSON.parse(initializeAggregator(e.cfg));return r.error?{type:t.Failed,reason:r.error}:{type:t.Initialized,result:r}}function o(e){const r=aggregate(e.result);return r!=null?{type:t.Failed,reason:JSON.parse(r).error}:{type:t.Done}}function l(){const e=JSON.parse(flush());return e.error?{type:t.Failed,reason:e.error}:{type:t.Result,result:e}}function u(e){switch(e.type){case n.Ready:return s(e);case n.Initialize:return postMessage(i(e));case n.Add:return postMessage(o(e));case n.Flush:return postMessage(l());default:throw console.error("aggregator - unknown request: ",e),new Error("aggregator unknown request")}}onmessage=e=>u(e.data);var n=(e=>(e.Ready="ready",e.Initialize="initialize",e.Add="add",e.Flush="flush",e))(n||{}),t=(e=>(e.Failed="failed",e.Ready="ready",e.Initialized="initialized",e.Done="done",e.Result="result",e))(t||{})})();
